<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Hello, Simulations!</title>
</head>
<body>

	<button>XID</button>
    <input type="text" value="3"/>
	<ul></ul>

	<script>
		var button = document.querySelector('button');

		var eventList = document.querySelector('ul');

	    //evtSource = new EventSource('inputDeck/1/results/sse');
   
	     var evtSource;
		

		button.onclick = function() {
			console.log('Connection closed');
			
			if(evtSource) evtSource.close();
			
			var xid = document.querySelector('input').value;
			
			var evtUrl = 'inputDeck/'+xid+'/xid/sse';
			
			evtSource = new EventSource(evtUrl);
			
			console.log(evtSource.withCredentials);
			console.log(" Conn state : " + evtSource.readyState);
			console.log(evtSource.url);
			
			evtSource.onmessage = function(e) {
				console.log("Got msg " + e.data);
				var newElement = document.createElement("li");
				newElement.textContent = e.data;
				eventList.appendChild(newElement);
			};

			evtSource.onerror = function() {
				console.log("EventSource failed.");
			};

			evtSource.onopen = function() {
				console.log("Connection to server opened.");
				console.log(" Conn state : " + evtSource.readyState);
			};
		};
	</script>
</body>
</html>